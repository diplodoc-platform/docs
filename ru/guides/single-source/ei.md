# Единый источник

Единый источник — это способ организации проекта, который позволяет получить несколько похожих версий документа из одного и того же исходного текста. Например, справки для разных платформ, языков или аудиторий.

Единый источник упрощает обновление проекта и снижает количество ошибок. Повторяющийся текст находится в одном месте, поэтому при обновлении не нужно искать и править все его вхождения.

### Примеры 

* [Справка Яндекс Почты](https://yandex.ru/support/yandex-360/customers/mail/ru/web/letter/create/letter-from-mobile?tabs=defaultTabsGroup-002l0bah_android)

Пользователь мобильного приложения Яндекс Почты может найти в справке инструкции, адаптированные под смартфон. В то же время пользователь веб-версии видит инструкции, учитывающие особенности работы с сервисом в браузере. При этом обе версии справки создаются на основе одного исходного текста.

* [Справка Яндекс Музыки](https://yandex.ru/support/music/ru/new-template/gettingstart)

После установки Яндекс Музыки пользователь может обратиться к справке, чтобы разобраться с работой сервиса. Справка содержит понятные инструкции, адаптированные под конкретную платформу.

* [Справка Кинопоиска](https://yandex.ru/support/kinopoisk/ru/authorization/get-started)

Если пользователь сталкивается с трудностями при авторизации в Кинопоиске, он может обратиться к справке. Там он найдет пошаговые инструкции, объясняющие все необходимые действия. При этом пользователи из разных стран или с других платформ увидят версии справки, учитывающие языковые и интерфейсные особенности.

## Методы работы с единым источником {#methods}

* [**Профилирование**](./profiling.md) используется для формирования нескольких похожих документов из одного документа-источника. Текст размечается с помощью [условных операторов](https://diplodoc.com/docs/ru/syntax/vars#conditions) или [переменных](https://diplodoc.com/docs/ru/syntax/vars). При сборке в каждый выходной документ подставляются только нужные фрагменты текста.

  Способ применяется, если общего контента больше, чем уникального.

  {% cut "Пример" %}

  В [справке Яндекс Почты](https://yandex.ru/support/yandex-360/customers/mail/ru/) в одном исходном тексте содержатся инструкции по работе с сервисом. С помощью профилирования из этого текста формируются две версии справки: 
  * для мобильного приложения включаются фрагменты, описывающие действия, специфичные для смартфона (например, действия для [написания письма](https://yandex.ru/support/yandex-360/customers/mail/ru/web/letter/create/letter-from-mobile?tabs=defaultTabsGroup-nrz4zeaf_android));
  * для веб-версии включаются фрагменты, описывающие действия, специфичные для браузера (например, [добавление файлов](https://yandex.ru/support/yandex-360/customers/mail/ru/web/letter/attachments)).

  {% endcut %}

* **Переиспользование** контента позволяет подставлять повторяющиеся фрагменты текста внутри одного или нескольких документов. 
    
    Способ применяется, если уникального контента больше, чем общего. 

    Переиспользование обеспечивают:
      
    * [Инклюды](./includes.md) — отдельные файлы с текстом, ссылки на которые вставляются в нужном месте текста. При сборке текст из файла подставляется полностью.

      {% cut "Пример" %}

      В [справке Яндекс Музыки](https://yandex.ru/support/music/ru/) некоторые разделы содержат повторяющуюся информацию, например, о [способах авторизации](https://yandex.ru/support/music/ru/new-template/gettingstart). Такие блоки оформляются в виде инклюдов и включаются в нужные места текста. При изменении способов авторизации достаточно отредактировать только один файл.

      {% endcut %}

    * [Пресеты переменных](./presets.md) — набор переменных и их значений. При сборке документа в текст подставляется значение переменной в зависимости от условий сборки.

      {% cut "Пример" %}

      В [справке Кинопоиска](https://yandex.ru/support/kinopoisk/ru/) в разделе [«Покупка и аренда фильмов»](https://yandex.ru/support/kinopoisk/ru/online/content/buing-renting) могут использоваться переменные для методов оплаты, которые зависят от региона. В пресетах задаются разные значения для переменных `метод_оплаты` в зависимости от страны пользователя. При генерации версии справки для конкретного региона в текст подставляются соответствующие значения, что позволяет предоставить пользователям информацию, релевантную их местоположению и доступным сервисам.

      {% endcut %}

    * [Вставки оглавлений](toc_includes.md) — блоки оглавления, которые вставляются в основное оглавление.

      {% cut "Пример" %}

      В [справке Яндекс Почты](https://yandex.ru/support/yandex-360/customers/mail/ru/) основная справка содержит несколько крупных разделов, например, [«Управление контактами»](https://yandex.ru/support/yandex-360/customers/mail/ru/web/abook), [«Настройка почтового ящика»](https://yandex.ru/support/yandex-360/customers/mail/ru/box-settings). Для каждого раздела создается свой блок оглавления, который включает подразделы и ключевые темы. С помощью вставок оглавлений эти блоки включаются в общее оглавление справки, что позволяет пользователям быстро находить нужные разделы и ориентироваться в большом объеме информации.

      {% endcut %}


## Особенности {#peculiaritys}

* Каталоги с изображениями и инклюдами принято размещать в папках с названием `_assets` и `_includes` соответственно. Символ `_` означает, что папка не будет отображаться в итоговой сборке, но может быть использована как источник.

* Внутри проекта с профилированием можно дополнительно использовать инклюды или пресеты переменных, поэтому способы можно комбинировать.

* Если из одного документа-источника необходимо опубликовать несколько документов на разных доменах, то нужно настроить конфигурационные файлы для [профилирования](./profiling.md#configs). В случае переиспользования возможна публикация нескольких документов только на одном домене с разными URL.
