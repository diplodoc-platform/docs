# Процедура запроса

Процедуру запроса к AppMetrica Logs API можно разделить на два этапа:

![](https://yastatic.net/s3/doc-binary/src/dev/appmetrica/{{locale}}/images/mobile-api/logsapi-scheme.png)

## Запрос на подготовку данных {#request-data-processing}

AppMetrica Logs API принимает запрос и помещает его в очередь для обработки. Если запрос обработан корректно, AppMetrica подготавливает файл для выгрузки. В этом случае API возвращает HTTP-статус `202 Accepted`. Если запрос вызвал ошибку, возвращается подходящий код ответа, а тело ответа содержит описание ошибки.

{% note info %}

Запросы в очереди обрабатываются последовательно (каждый последующий выполняются строго после завершения предыдущего).

{% endnote %}

Во время выполнения запроса и подготовки файла, все идентичные запросы (с такими же параметрами) вернут HTTP-статус `202 Accepted`.

Пример запроса:

```no-highlight translate=no
GET /logs/v1/export/installations.json HTTP/1.1
Host: api.appmetrica.yandex.ru
Authorization: OAuth <your_token>
```

где `<your_token>` — это OAuth-токен, который можно получить по [инструкции](../intro/authorization.md#get-oauth-token).

Пример ответа:

```no-highlight translate=no
HTTP/1.1 202 Accepted
Content-Type: text/plain

Wait for result
```

Чтобы получать данные в сжатом виде, необходимо в запросе передать HTTP заголовок `Accept-Encoding: gzip`.

## Запрос на выгрузку данных {#request-data-uploading}

Запрос на выгрузку данных идентичен запросу на подготовку. Если запрос на подготовку файла завершен, при следующем идентичном запросе Logs API возвращает HTTP-статус `200 OK`. Файл с результатом запроса готов к загрузке.

Файл доступен для загрузки в течение 24 часов по URL первоначального запроса. При повторном запросе по истечении 24 часов, запрос помещается в очередь для обработки и формирования нового файла.

Вы можете вручную запросить повторную обработку запроса с помощью HTTP заголовка `Cache-Control`:

- Для формирования нового файла отправить при запросе заголовок `Cache-Control: no-cache`.
- Для скачивания файла, который сформирован не более чем N секунд назад, отправить при запросе заголовок `Cache-Control: max-age=N`. Если файл был создан более чем N секунд назад, AppMetrica формирует новый файл.
- Для скачивания последнего сформированного файла, если он существует, не отправлять при запросе заголовок `Cache-Control`.

{{ feedback }}

<a href="../../troubleshooting/feedback-new.html">
  <span class="button">Написать в службу поддержки</span>
</a>

{% include notitle [feedback](../../_includes/feedback-button.md) %}
